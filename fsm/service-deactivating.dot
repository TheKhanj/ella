// MIT License
// Copyright (c) 2025 Pooyan Khanjankhani

digraph service_states {
	label="Service Deactivating Finite State Machine";
	rankdir=LR;
	fontname="Ubuntu";
	style=solid;
	graph [pad="0.5"];
	node [shape=circle, style=filled, fillcolor=lightblue, fontname="Ubuntu"];
	{ rank=max; inactive; };
	{ rank=same; active; };

	// States
	inactive               [label="inactive", fillcolor="lightgray"];
	active                 [label="active", fillcolor="lightgreen"];
	failed                 [label="failed", fillcolor="lightcoral"];

	subgraph cluster_deactivating {
		label="Deactivating";
		style=dashed;
		fontsize=20;

		deactivating_stop        [label="deactivating_stop"];
		deactivating_sigkill     [label="deactivating_sigkill"];
		deactivating_post_stop   [label="deactivating_post_stop"];
	}

	// Transitions
	active                 -> deactivating_stop      [label="stop"]
	deactivating_stop      -> deactivating_sigkill   [label="timed out"]
	deactivating_stop      -> deactivating_post_stop [label="process exited"]
	deactivating_sigkill   -> deactivating_post_stop [label="killed"]
	deactivating_post_stop -> inactive               [label="post stop exec done"]
	deactivating_post_stop -> failed                 [label="post stop exec failed"]
}
