digraph service_states {
	label="Service Finite State Machine"
	rankdir=LR;
	fontname="Ubuntu"
	graph [pad="0.5"];
	node [shape=circle, style=filled, fillcolor=lightblue, fontname="Ubuntu"];
	{ rank=min; inactive; };
	{ rank=same; reloading; active; };

	// States
	inactive     [label="inactive", fillcolor="lightgray"];
	active       [label="active", fillcolor="lightgreen"];
	failed       [label="failed", fillcolor="lightcoral"];
	activating   [label="activating"];
	deactivating [label="deactivating"];
	reloading    [label="reloading"];

	// Start transition
	inactive     -> activating   [label="start"];
	failed       -> activating   [label="start (restart/auto-restart)"];
	activating   -> active       [label="start done (watchdog)"];

	// Watchdog
	active       -> failed       [label="fail (watchdog)"];

	// Stop transition
	active       -> deactivating [label="stop"];
	deactivating -> failed       [label="fail"];
	deactivating -> inactive     [label="stop done"];
	activating   -> failed       [label="fail (watchdog)"];

	// Reload transition
	active       -> reloading    [label="reload"];
	reloading    -> active       [label="reload done"];
}
